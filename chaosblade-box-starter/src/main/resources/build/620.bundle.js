/*
 * Copyright 2025 The ChaosBlade Authors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

(self.webpackChunk=self.webpackChunk||[]).push([[620],{39620:function(F,_,e){var g,C,P,A=e(24596),h=e(67394),S=e(93168),G=e(23587),pe=e(83452),q=e(95315),ee=e(63774),fe=e(92937);(function(K,W){if(!0)!(C=[_,e(12955),e(93080),e(72153),e(28757),e(15286),e(17534),e(77809),e(57379),e(88162),e(81853),e(30553),e(8583),e(27378),e(66697),e(98784),e(14798),e(68055),e(13988),e(99328),e(14870),e(19e3)],g=W,P=typeof g=="function"?g.apply(_,C):g,P!==void 0&&(F.exports=P));else var j})(typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:this,function(K,W,j,X,z,R,V,H,J,Q,D,x,L,t,I,w,a,Z,b,te,me,k){"use strict";var r=e(67971);h(K,"__esModule",{value:!0}),K.default=void 0,W=r(W),j=r(j),X=r(X),z=r(z),R=r(R),V=r(V),H=r(H),J=r(J),Q=r(Q),D=r(D),x=r(x),L=r(L),t=Ee(t),I=r(I),w=r(w),a=r(a),Z=r(Z),b=r(b),k=r(k);function ae(l){if(typeof S!="function")return null;var p=new S,u=new S;return(ae=function(U){return U?u:p})(l)}function Ee(l,p){if(!p&&l&&l.__esModule)return l;if(l===null||A(l)!=="object"&&typeof l!="function")return{default:l};var u=ae(p);if(u&&u.has(l))return u.get(l);var o={},U=h&&G;for(var v in l)if(v!=="default"&&Object.prototype.hasOwnProperty.call(l,v)){var O=U?G(l,v):null;O&&(O.get||O.set)?h(o,v,O):o[v]=l[v]}return o.default=l,u&&u.set(l,o),o}function le(l,p){var u=pe(l);if(q){var o=q(l);p&&(o=o.filter(function(U){return G(l,U).enumerable})),u.push.apply(u,o)}return u}function ne(l){for(var p=1;p<arguments.length;p++){var u=arguments[p]!=null?arguments[p]:{};p%2?le(Object(u),!0).forEach(function(o){(0,J.default)(l,o,u[o])}):ee?fe(l,ee(u)):le(Object(u)).forEach(function(o){h(l,o,G(u,o))})}return l}var y=L.default.Item,ce={labelCol:{fixedSpan:6},wrapperCol:{span:18}},he=x.default.Group,ve=function(p){var u=p.onClose,o=(0,me.useDispatch)(),U=(0,t.useState)([]),v=(0,D.default)(U,2),O=v[0],ue=v[1],Pe=(0,t.useState)(!1),de=(0,D.default)(Pe,2),Re=de[0],oe=de[1],_e=Q.default.useField(),Ae=(0,t.useState)({appType:1}),re=(0,D.default)(Ae,2),i=re[0],se=re[1],Se=(0,t.useState)(null),ie=(0,D.default)(Se,2),E=ie[0],ye=ie[1];(0,t.useEffect)(function(){se(ne(ne({},i),{},{AppName:void 0,AppGroupName:void 0}))},[i==null?void 0:i.appType]),(0,t.useEffect)(function(){var f=function(){var s=(0,H.default)(regeneratorRuntime.mark(function d(){var n,m,N,M,T,$,B;return regeneratorRuntime.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return N=(n=(m=(0,te.getParams)("ns"))!==null&&m!==void 0?m:window.curNamespace)!==null&&n!==void 0?n:"default",M={namespace:N,region:(0,te.getActiveRegion)(),appType:"0"},E&&(M.app_id=E.app_id),c.next=5,o.agentSetting.getGetUserApplicationGroups(M);case 5:T=c.sent,$=T.Data,B=$===void 0?[]:$,ue(B);case 9:case"end":return c.stop()}},d)}));return function(){return s.apply(this,arguments)}}();i!=null&&i.AppName&&(i==null?void 0:i.appType)===1&&(ue([]),f())},[E==null?void 0:E.app_id]);var Ue=function(){var f=(0,H.default)(regeneratorRuntime.mark(function s(d){var n,m,N,M,T,$,B;return regeneratorRuntime.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return oe(!0),n=w.default.cloneDeep(d),n.appType===1&&(n.AppName=E==null?void 0:E.app_name,n.AppId=E==null?void 0:E.app_id),delete n.appType,c.next=6,o.agentSetting.getInstallPlugin(n);case 6:m=c.sent,N=m.Data,M=N===void 0?!1:N,T=m.Code,$=T===void 0?"":T,oe(!1),M?(V.default.success(a.default.t("The probe is being installed, this may take a few minutes, please check later...")),u()):(B=a.default.t("The automatic installation of the probe failed, please try to install it manually"),$==="plugin.instance.not.exist"&&(B=a.default.t("The current instance does not exist, please select an available instance")),V.default.error(B));case 13:case"end":return c.stop()}},s)}));return function(d){return f.apply(this,arguments)}}(),Y=function(s,d,n,m){m==="InstanceId"&&/^((25[0-5]|2[0-4]\d|((1\d{2})|([1-9]?\d)))\.){3}(25[0-5]|2[0-4]\d|((1\d{2})|([1-9]?\d)))$/.test(d)===!1?n(a.default.t("Please fill in the legitimate machine IP address")):m==="SshPort"&&!(/^[1-9]\d*$/.test(d)&&Number(d)>=1&&Number(d)<=65535)?n(a.default.t("Please fill in valid port")):["AppName","AppGroupName"].includes(m)&&/^[\w|\||-]*$/g.test(d)===!1?n("".concat(a.default.t("Please fill in legal"),"\b").concat(m==="AppName"?a.default.t("Application"):a.default.t("Group")).concat(a.default.t("Name"))):n()};return t.default.createElement(W.default,{visible:!0,title:a.default.t("Install the probe").toString(),style:{width:"680px"},okProps:{children:a.default.t("Install").toString()},footer:!1,onCancel:u,onClose:u,locale:(0,Z.default)().Dialog},t.default.createElement("div",{className:b.default.installDialog},t.default.createElement(L.default,(0,j.default)({},ce,{field:_e,onChange:function(s){se(s)}}),t.default.createElement(y,{required:!0,label:a.default.t("Application").toString()},t.default.createElement(he,{name:"appType",defaultValue:i.appType},t.default.createElement(x.default,{value:1},t.default.createElement(I.default,null,"Existing application")),t.default.createElement(x.default,{value:2},t.default.createElement(I.default,null,"Add application")))),t.default.createElement(y,{label:a.default.t("Choose application").toString(),required:!0},i.appType===1&&t.default.createElement(k.default,{params:{filterDisabled:!0,appType:0},placeholder:a.default.t("Please select an app name").toString(),name:"AppName",value:i.AppName,onChange:function(s,d,n){ye(n)}})||t.default.createElement(R.default,{value:i.AppName,placeholder:a.default.t("Please input application name").toString(),name:"AppName"})),t.default.createElement(y,{label:a.default.t("Application group").toString(),validator:function(s,d,n){return Y(s,d,n,"AppGroupName")}},i.appType===1&&t.default.createElement(z.default,{showSearch:!0,value:i.AppGroupName,style:{width:"100%"},dataSource:O,placeholder:a.default.t("Please select an app group"),name:"AppGroupName",locale:(0,Z.default)().Select})||t.default.createElement(R.default,{value:i.AppGroupName,placeholder:a.default.t("Please input application group").toString(),name:"AppGroupName"})),t.default.createElement(y,{label:a.default.t("IP").toString(),required:!0,validator:function(s,d,n){return Y(s,d,n,"InstanceId")}},t.default.createElement(R.default,{placeholder:a.default.t("Please input the machine ip").toString(),name:"InstanceId"})),t.default.createElement(y,{label:a.default.t("port").toString(),validator:function(s,d,n){return Y(s,d,n,"SshPort")}},t.default.createElement(R.default,{placeholder:a.default.t("Please enter the port"),name:"SshPort",defaultValue:22})),t.default.createElement(y,{label:a.default.t("SSH user").toString(),required:!0,validator:function(s,d,n){return Y(s,d,n,"SshUser")}},t.default.createElement(R.default,{placeholder:a.default.t("Please enter SSH user").toString(),name:"SshUser"})),t.default.createElement(y,{label:a.default.t("SSH password").toString()},t.default.createElement(R.default,{htmlType:"password",placeholder:a.default.t("Please enter SSH password").toString(),name:"SshPassword"})),t.default.createElement("div",{style:{textAlign:"right"}},t.default.createElement(L.default.Submit,{validate:!0,type:"primary",loading:Re,onClick:function(s){return Ue(s)},style:{marginRight:10}},t.default.createElement(I.default,null,"Install")),t.default.createElement(X.default,{onClick:function(){return u()}},t.default.createElement(I.default,null,"cancel"))))))},ge=(0,t.memo)(ve);K.default=ge})},86901:(F,_,e)=>{"use strict";e.d(_,{Z:()=>S});var g=e(60994),C=e.n(g),P=e(93476),A=e.n(P),h=A()(C());h.push([F.id,`.index__installDialog__bDteq label:before {
    margin-right: 4px;
    content: " ";
    display: inline-block;
    width: 6px;
  }`,"",{version:3,sources:["webpack://./pages/Manage/AutoInstall/index.css"],names:[],mappings:"AACE;IACE,iBAAiB;IACjB,YAAY;IACZ,qBAAqB;IACrB,UAAU;EACZ",sourcesContent:[`.installDialog {
  label:before {
    margin-right: 4px;
    content: " ";
    display: inline-block;
    width: 6px;
  } 
}`],sourceRoot:""}]),h.locals={installDialog:"index__installDialog__bDteq"};const S=h},13988:(F,_,e)=>{"use strict";e.r(_),e.d(_,{default:()=>S});var g=e(1892),C=e.n(g),P=e(86901),A={};A.insert="head",A.singleton=!1;var h=C()(P.Z,A);const S=P.Z.locals||{}}}]);

//# sourceMappingURL=620.bundle.js.map